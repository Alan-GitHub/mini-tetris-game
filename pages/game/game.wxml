<view class="game-container">
  <!-- Header Info -->
  <view class="game-header">
    <view class="info-box">
      <view class="info-label">分数</view>
      <view class="info-value">{{score}}</view>
    </view>
    <view class="info-box">
      <view class="info-label">等级</view>
      <view class="info-value">{{level}}</view>
    </view>
    <view class="info-box">
      <view class="info-label">行数</view>
      <view class="info-value">{{lines}}</view>
    </view>
  </view>

  <!-- Game Area -->
  <view class="game-area">
    <!-- Canvas -->
    <view class="canvas-wrapper">
      <canvas 
        type="2d" 
        id="gameCanvas" 
        class="game-canvas"
        bindtouchstart="onTouchStart"
        bindtouchend="onTouchEnd"
      ></canvas>
    </view>
    
    <!-- Next Piece Preview -->
    <view class="next-box">
      <view class="next-label">下一个</view>
      <view class="next-preview" wx:if="{{nextPiece}}">
        <view 
          class="preview-row" 
          wx:for="{{nextPiece.shape}}" 
          wx:for-item="row" 
          wx:key="index"
        >
          <view 
            class="preview-cell {{cell ? 'active' : ''}}" 
            wx:for="{{row}}" 
            wx:for-item="cell" 
            wx:key="index"
            style="background-color: {{cell ? nextPiece.color : 'transparent'}}"
          ></view>
        </view>
      </view>
    </view>
  </view>

  <!-- Controls -->
  <view class="controls">
    <view class="control-row">
      <button class="control-btn rotate-btn" bindtap="onRotate">旋转</button>
    </view>
    <view class="control-row">
      <button class="control-btn" bindtap="onLeft">←</button>
      <button 
        class="control-btn down-btn" 
        bindtap="onDown"
        bindlongpress="onDownLongPress"
        bindtouchend="onDownTouchEnd"
        bindtouchcancel="onDownTouchEnd"
      >↓</button>
      <button class="control-btn" bindtap="onRight">→</button>
    </view>
    <view class="control-row">
      <button class="control-btn drop-btn" bindtap="onDrop">快速下落</button>
    </view>
  </view>

  <!-- Top Buttons -->
  <view class="top-buttons">
    <button class="top-btn sound-btn" bindtap="toggleSound">
      {{soundEnabled ? '🔊' : '🔇'}}
    </button>
    <button class="top-btn pause-btn" bindtap="onPause">
      {{paused ? '▶' : '⏸'}}
    </button>
  </view>

  <!-- Game Over Modal -->
  <view class="modal" wx:if="{{gameOver}}">
    <view class="modal-content">
      <view class="modal-title">游戏结束</view>
      <view class="modal-score">最终得分: {{score}}</view>
      <view class="modal-buttons">
        <button class="modal-btn restart-btn" bindtap="onRestart">重新开始</button>
        <button class="modal-btn back-btn" bindtap="onBack">返回首页</button>
      </view>
    </view>
  </view>

  <!-- Pause Modal -->
  <view class="modal pause-modal" wx:if="{{paused && !gameOver}}">
    <view class="modal-content">
      <view class="modal-title">游戏暂停</view>
      <view class="modal-buttons">
        <button class="modal-btn restart-btn" bindtap="onPause">继续游戏</button>
        <button class="modal-btn back-btn" bindtap="onBack">返回首页</button>
      </view>
    </view>
  </view>
</view>
